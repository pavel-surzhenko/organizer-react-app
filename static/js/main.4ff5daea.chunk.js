(this.webpackJsonporganizer=this.webpackJsonporganizer||[]).push([[0],{279:function(e,t,s){},283:function(e,t,s){"use strict";s.r(t);var a=s(20),r=s(6),c=s(12),n=s(5),o=s(11);const i=Object.freeze({SET_TOKEN:"SET_TOKEN",SET_ERROR:"SET_ERROR",RESET_ERROR:"RESET_ERROR"}),l=Object.freeze({FETCH_TASKS:"FETCH_TASKS",START_FETCHING:"START_FETCHING",STOP_FETCHING:"STOP_FETCHING",SET_SELECTED_TASK:"SET_SELECTED_TASK"}),d=Object.freeze({FETCH_TASKS:"FETCH_TAGS",START_FETCHING:"START_FETCHING",STOP_FETCHING:"STOP_FETCHING",SET_SELECTED_TAG_ID:"SET_SELECTED_TAG_ID"}),j=Object.freeze({resetError:()=>({type:i.RESET_ERROR}),setError:e=>({type:i.SET_ERROR,error:!0,payload:e}),setToken:e=>({type:i.SET_TOKEN,payload:e})});var b=s(21),O=s.n(b);const m="https://lab.lectrum.io",g=`${m}/rtx/api/v2/todos/tasks`,h=`${m}/rtx/api/v2/todos/auth`,u=`${m}/rtx/api/v2/todos/tags`,p=Object.freeze({get token(){return localStorage.getItem("token")},auth:{async signup(e){try{const{data:t}=await O.a.post(`${h}/registration`,e,{headers:{"Content-type":"application/json"}});return t}catch(t){return t.response.data||{message:"Unknown error occurred"}}},async login(e){try{const{data:t}=await O.a.get(`${h}/login`,{headers:{Authorization:`Basic ${e}`}});return t}catch(t){return t.response.data||{message:"Unknown error occurred"}}},async logout(){try{await O.a.get(`${h}/logout`,{headers:{Authorization:`Bearer ${p.token}`}})}catch(e){return e.response.data||{message:"Unknown error occurred"}}}},tasks:{async getTasks(){const{data:e}=await O.a.get(g,{headers:{Authorization:`Bearer ${p.token}`}});return null===e||void 0===e?void 0:e.data},async create(e){try{const{data:t}=await O.a.post(g,e,{headers:{Authorization:`Bearer ${p.token}`}});return t}catch(t){return t.response.data||{message:"Unknown error occurred"}}},async delete(e){try{await O.a.delete(`${g}/${e}`,{headers:{Authorization:`Bearer ${p.token}`}})}catch(t){return t.response.data||{message:"Unknown error occurred"}}},async update(e,t){try{const{data:s}=await O.a.put(`${g}/${t}`,e,{headers:{Authorization:`Bearer ${p.token}`}});return s}catch(s){return s.response.data||{message:"Unknown error occurred"}}}},tags:{async getTags(){const{data:e}=await O.a.get(u);return e}}}),T=Object.freeze({setTaskId:e=>({type:l.SET_SELECTED_TASK,payload:e}),startFetching:()=>({type:l.START_FETCHING}),stopFetching:()=>({type:l.STOP_FETCHING}),fetchTask:e=>({type:l.FETCH_TASKS,payload:e}),fetchTaskAsync:()=>async e=>{try{e(T.startFetching());const t=await p.tasks.getTasks();e(T.fetchTask(t))}catch(t){const{message:s}=t;e(j.setError(s))}finally{e(T.stopFetching())}}}),x=Object.freeze({startFetching:()=>({type:d.START_FETCHING}),stopFetching:()=>({type:d.STOP_FETCHING}),fetchTags:e=>({type:d.FETCH_TASKS,payload:e}),fetchTagsAsync:()=>async e=>{try{e(x.startFetching());const t=await p.tags.getTags();e(x.fetchTags(t))}catch(t){const{message:s}=t;e(j.setError(s))}finally{e(x.stopFetching())}},setTagId:e=>({type:d.SET_SELECTED_TAG_ID,payload:e})}),E=e=>e.auth.errorMessage,S=e=>e.task.tasks,k=e=>e.task.id,y=e=>e.tag.tags,v=e=>e.tag.tagId;var f=s(2);const N=e=>{const t=Object(r.b)(),s=Object(r.c)(v);return Object(f.jsx)("span",{onClick:()=>{t(x.setTagId(e.id))},className:"tag "+(s===e.id?"selected":""),style:{color:`${null===e||void 0===e?void 0:e.color}`,backgroundColor:`${null===e||void 0===e?void 0:e.bg}`},children:e.name})},w=()=>{const e="/task-manager"===Object(n.g)().pathname,t=Object(r.b)(),s=Object(n.h)();return Object(f.jsxs)("nav",{children:[!e&&Object(f.jsx)(c.c,{to:"/login",children:"Log in"}),Object(f.jsx)(c.c,{to:"/task-manager",children:"To tasks"}),e&&Object(f.jsx)(c.b,{to:"",onClick:async()=>{const e=await p.auth.logout();e?t(j.setError(e.message)):(Object(o.c)("See you soon"),localStorage.removeItem("token"),s("/login"))},children:"Log out"})]})};var _=s(14),C=s(31),F=s(8);var R=s(7);const I=R.b().shape({email:R.d().email().required(""),password:R.d().min(8).required("")}),A=()=>{const e=Object(r.b)(),t=Object(n.h)(),s=Object(F.e)({mode:"all",resolver:Object(C.a)(I)}),a=s.handleSubmit((async s=>{const a=await(async e=>await p.auth.login(window.btoa(`${null===e||void 0===e?void 0:e.email}:${null===e||void 0===e?void 0:e.password}`)))(s);"data"in a?(localStorage.setItem("token",a.data),e(j.setToken(a.data)),Object(o.c)("Welcome"),t("/task-manager")):e(j.setError(a.message))}));return Object(f.jsx)("section",{className:"sign-form",children:Object(f.jsxs)("form",{onSubmit:a,children:[Object(f.jsxs)("fieldset",{children:[Object(f.jsx)("legend",{children:"Log in"}),Object(f.jsxs)("label",{className:"label",children:[Object(f.jsx)("input",{placeholder:"Email",type:"text",...s.register("email")}),Object(f.jsx)(_.a,{errors:s.formState.errors,name:"email",render:e=>{let{message:t}=e;return Object(f.jsx)("span",{className:"errorMessage",children:t})}})]}),Object(f.jsxs)("label",{className:"label",children:[Object(f.jsx)("input",{type:"password",placeholder:"Password",...s.register("password")}),Object(f.jsx)(_.a,{errors:s.formState.errors,name:"password",render:e=>{let{message:t}=e;return Object(f.jsx)("span",{className:"errorMessage",children:t})}})]}),Object(f.jsx)("input",{type:"submit",className:"button-login",value:"log in",disabled:!s.formState.isValid})]}),Object(f.jsxs)("p",{children:["if you don't have an account, you can.",Object(f.jsx)(c.b,{to:"/signup",children:" register"})]})]})})},D=R.b().shape({name:R.d().min(3).required(""),email:R.d().email().required(""),password:R.d().min(8).required(""),confirmPassword:R.d().oneOf([R.c("password")]).required("passwords do not match")}),H=()=>{const e=Object(r.b)(),t=Object(n.h)(),s=Object(F.e)({mode:"onTouched",resolver:Object(C.a)(D)}),a=s.handleSubmit((async s=>{const{confirmPassword:a,...r}=s,c=await p.auth.signup(r);"data"in c?(e(j.setToken(c.data)),localStorage.setItem("token",c.data),t("/task-manager")):e(j.setError(c.message))}));return Object(f.jsx)("section",{className:"publish-tip sign-form",children:Object(f.jsxs)("form",{onSubmit:a,children:[Object(f.jsxs)("fieldset",{children:[Object(f.jsx)("legend",{children:"Registration"}),Object(f.jsxs)("label",{className:"label",children:[Object(f.jsx)("input",{placeholder:"Name",type:"text",...s.register("name")}),Object(f.jsx)(_.a,{errors:s.formState.errors,name:"name",render:e=>{let{message:t}=e;return Object(f.jsx)("span",{className:"errorMessage",children:t})}})]}),Object(f.jsxs)("label",{className:"label",children:[Object(f.jsx)("input",{type:"text",placeholder:"Email",...s.register("email")}),Object(f.jsx)(_.a,{errors:s.formState.errors,name:"email",render:e=>{let{message:t}=e;return Object(f.jsx)("span",{className:"errorMessage",children:t})}})]}),Object(f.jsxs)("label",{className:"label",children:[Object(f.jsx)("input",{type:"Password",placeholder:"Password",...s.register("password")}),Object(f.jsx)(_.a,{errors:s.formState.errors,name:"password",render:e=>{let{message:t}=e;return Object(f.jsx)("span",{className:"errorMessage",children:t})}})]}),Object(f.jsxs)("label",{className:"label",children:[Object(f.jsx)("input",{type:"password",placeholder:"Confirm password",...s.register("confirmPassword",{shouldUnregister:!1})}),Object(f.jsx)(_.a,{errors:s.formState.errors,name:"confirmPassword",render:()=>Object(f.jsx)("span",{className:"errorMessage",children:"passwords do not match"})})]}),Object(f.jsx)("input",{type:"submit",className:"button-login",value:"Register"})]}),Object(f.jsxs)("p",{children:["to",Object(f.jsx)(c.b,{to:"/login",children:" login"})]})]})})};var $=s(285);const G=e=>{const t=Object(r.b)(),{title:s,deadline:a,tag:c,completed:n,id:o}=e,i=Object($.default)(new Date(a),"d MMM, yyyy");return Object(f.jsxs)("div",{onClick:()=>{t(T.setTaskId(o)),t(x.setTagId(c.id))},className:"task "+(n?"completed":""),children:[Object(f.jsx)("span",{className:"title",children:s}),Object(f.jsxs)("div",{className:"meta",children:[Object(f.jsx)("span",{className:"deadline",children:i}),Object(f.jsx)(N,{...c})]})]})};var M=s(0),P=s(106),z=s.n(P);const K=Object.freeze({position:"top-right",autoClose:7e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),L=Object.freeze({position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0}),B=R.b().shape({title:R.d().min(3).required(""),deadline:R.a(),description:R.d().min(3).required("*"),tag:R.d()}),q=e=>{const t=Object(r.b)(),s=Object(r.c)(v),a="new"===Object(r.c)(k),c=Object(F.e)({mode:"onTouched",resolver:Object(C.a)(B)});Object(M.useEffect)((()=>{t(x.fetchTagsAsync()),c.setFocus("title")}),[]);const n=Object(r.c)(y).map((e=>Object(f.jsx)(N,{...e},e.id))),[i,l]=Object(M.useState)((null===e||void 0===e?void 0:e.deadline)?new Date(e.deadline):new Date);Object(M.useEffect)((()=>{c.reset(),l((null===e||void 0===e?void 0:e.deadline)?new Date(e.deadline):new Date)}),[e]);const d=c.handleSubmit((async r=>{const n={completed:!1,title:r.title,description:r.description,deadline:i.toJSON(),tag:s},l=a?await p.tasks.create(n):await p.tasks.update(n,null===e||void 0===e?void 0:e.id);"data"in l?(t(T.setTaskId("")),t(T.fetchTaskAsync()),o.c.success(""+(a?"Task created":"Task updated"),L),c.reset()):"message"in l&&t(j.setError(l.message))}));return Object(f.jsx)("div",{className:"task-card",children:Object(f.jsxs)("form",{onSubmit:d,children:[Object(f.jsx)("div",{className:"head",children:a?"":Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{type:"button",onClick:async()=>{const a={completed:!0,title:c.watch("title"),description:c.watch("description"),deadline:i.toJSON(),tag:s},r=await p.tasks.update(a,null===e||void 0===e?void 0:e.id);"data"in r?(t(T.setTaskId("")),t(T.fetchTaskAsync()),o.c.info("Task completed",L)):"message"in r&&t(j.setError(r.message))},className:"button-complete-task",children:"to complete"}),Object(f.jsx)("div",{onClick:async()=>{const s=await p.tasks.delete(e.id);s?t(j.setError(s.message)):(t(T.setTaskId("")),t(T.fetchTaskAsync()),o.c.success("Task deleted",L))},className:"button-remove-task"})]})}),Object(f.jsxs)("div",{className:"content",children:[Object(f.jsxs)("label",{className:"label",children:["Tasks",Object(f.jsx)("input",{defaultValue:`${a?"":e.title}`,type:"text",className:"title",placeholder:"Do homeworks",...c.register("title")})]}),Object(f.jsxs)("div",{className:"deadline",children:[Object(f.jsx)("span",{className:"label",children:"Deadline"}),Object(f.jsx)("span",{className:"date",children:Object(f.jsx)("div",{className:"react-datepicker-wrapper",children:Object(f.jsx)("div",{className:"react-datepicker__input-container",children:Object(f.jsx)(F.a,{name:"deadline",control:c.control,defaultValue:i,render:e=>{let{field:t}=e;return Object(f.jsx)(z.a,{minDate:new Date,selected:i,onChange:e=>t.onChange(l(e)),dateFormat:"d MMM, yyyy"})}})})})})]}),Object(f.jsx)("div",{className:"description",children:Object(f.jsxs)("label",{className:"label",children:["Description",Object(f.jsx)("textarea",{defaultValue:`${a?"":e.description}`,className:"text",placeholder:"Do homework before the weekend",...c.register("description")})]})}),Object(f.jsx)("div",{className:"tags",children:n}),Object(f.jsxs)("div",{className:"errors",children:[Object(f.jsx)(_.a,{errors:c.formState.errors,name:"title",render:e=>{let{message:t}=e;return Object(f.jsx)("p",{className:"errorMessage",children:t})}}),Object(f.jsx)(_.a,{errors:c.formState.errors,name:"description",render:e=>{let{message:t}=e;return Object(f.jsx)("p",{className:"errorMessage",children:t})}})]}),Object(f.jsxs)("div",{className:"form-controls",children:[Object(f.jsx)("button",{className:"button-reset-task",type:"reset",onClick:()=>{c.reset(),l((null===e||void 0===e?void 0:e.deadline)?new Date(e.deadline):new Date)},children:"Reset"}),Object(f.jsx)("button",{className:"button-save-task",type:"submit",disabled:!c.formState.isValid||!s,children:"Save"})]})]})]})})},U=()=>{const e=Object(r.b)(),t=Object(r.c)(S),s=Object(r.c)(k),a=t.find((e=>e.id===s));Object(M.useEffect)((()=>{e(T.fetchTaskAsync())}),[]);const c=t.map((e=>Object(f.jsx)(G,{...e},e.id)));return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",{className:"controls",children:[Object(f.jsx)("i",{className:"las"}),Object(f.jsx)("button",{onClick:()=>{e(T.setTaskId("new")),e(x.setTagId(""))},className:"button-create-task",children:"New Task"})]}),Object(f.jsxs)("div",{className:"wrap",children:[Object(f.jsx)("div",{className:t.length?"list":"list empty",children:Object(f.jsx)("div",{className:"tasks",children:c})}),"new"===s&&Object(f.jsx)(q,{})||s&&Object(f.jsx)(q,{...a})]})]})},V=()=>{const e=localStorage.getItem("token"),t=Object(n.h)();Object(M.useEffect)((()=>{t(e?"/task-manager":"/login")}),[])},J=()=>(document.title="Login",V(),Object(f.jsx)(A,{})),X=()=>(document.title="Registration",Object(f.jsx)(H,{})),W=()=>(document.title="Tasks manager",V(),Object(f.jsx)(U,{})),Q=()=>((()=>{const e=Object(r.c)(E),t=Object(r.b)();Object(M.useEffect)((()=>{e&&(o.c.error(e,K),t(j.resetError()))}),[e])})(),V(),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(o.b,{newestOnTop:!0,transition:o.a}),Object(f.jsx)(w,{}),Object(f.jsx)("main",{children:Object(f.jsxs)(n.d,{children:[Object(f.jsx)(n.b,{path:"/login",element:Object(f.jsx)(J,{})}),Object(f.jsx)(n.b,{path:"/signup",element:Object(f.jsx)(X,{})}),Object(f.jsx)(n.b,{path:"/task-manager",element:Object(f.jsx)(W,{})}),Object(f.jsx)(n.b,{path:"*",element:Object(f.jsx)(n.a,{to:"/task-manager",replace:!0})})]})})]}));var Y=s(27);const Z={token:"",errorMessage:"",error:!1},ee={id:"",tasks:[],isFetching:!1},te={tagId:"",tags:[],isFetching:!1},se=Object(Y.b)({auth:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.SET_TOKEN:return{...e,token:t.payload,error:!1,errorMessage:""};case i.RESET_ERROR:return{...e,error:!1,errorMessage:""};case i.SET_ERROR:return{...e,error:!0,errorMessage:t.payload};default:return e}},task:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l.START_FETCHING:return{...e,isFetching:!0};case l.STOP_FETCHING:return{...e,isFetching:!1};case l.FETCH_TASKS:return{...e,isFetching:!0,tasks:null===t||void 0===t?void 0:t.payload};case l.SET_SELECTED_TASK:return{...e,id:null===t||void 0===t?void 0:t.payload};default:return e}},tag:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d.START_FETCHING:return{...e,isFetching:!0};case d.STOP_FETCHING:return{...e,isFetching:!1};case d.FETCH_TASKS:return{...e,isFetching:!0,tags:null===t||void 0===t?void 0:t.payload};case d.SET_SELECTED_TAG_ID:return{...e,tagId:null===t||void 0===t?void 0:t.payload};default:return e}}});var ae=s(109),re=s(110);Object(ae.createLogger)({duration:!0,collapsed:!0,colors:{title:e=>e.error?"firebrick":"deepskyblue",prevState:()=>"#1C5FAF",action:()=>"#149945",nextState:()=>"#A47104",error:()=>"#ff0005"}}),window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__;const ce=Y.c,ne=[re.a];const oe=Object(Y.d)(se,ce(Object(Y.a)(...ne)));s(279),s(280),s(281);Object(a.render)(Object(f.jsx)(r.a,{store:oe,children:Object(f.jsx)(c.a,{children:Object(f.jsx)(Q,{})})}),document.getElementById("root"),(()=>{console.log("%c \u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043e ","background: #00ff00; color: #000000; padding: 2.5px;")}))}},[[283,1,2]]]);
//# sourceMappingURL=main.4ff5daea.chunk.js.map